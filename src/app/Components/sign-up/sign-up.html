<div class="container mt-4">
  <h2>User Registration</h2>

  <form (ngSubmit)="AddUser()" #regForm="ngForm"  novalidate>

    <div class="mb-3">
      <label class="form-label">Full Name</label>
      <input type="text"
             name="name"
             class="form-control"
             [(ngModel)]="user.name"
             #fullName="ngModel"
             required
             minlength="5"
             [class.is-invalid]="fullName.invalid && fullName.touched"
             [class.is-valid]="fullName.valid">

       @if(fullName.invalid && fullName.touched){
      <div>
        @if(fullName.errors?.['required']){
        <div class="alert alert-danger mt-2">
          Full Name is required.
        </div>
      }
        @if(fullName.errors?.['minlength']){
        <div class="alert alert-warning mt-2">
          Full Name must be at least 5 characters.
        </div>
      }
      </div>

    }
    </div>

    <!-- Email -->
    <div class="mb-3">
      <label class="form-label">Email</label>
      <input type="email"
             name="email"
             class="form-control"
             [(ngModel)]="user.email"
             #email="ngModel"
             required email
             [class.is-invalid]="email.invalid && email.touched"
             [class.is-valid]="email.valid">

       @if(email.invalid && email.touched){
      <div>
       @if(email.errors?.['required']){

        <div class="alert alert-danger mt-2">
          Email is required.
        </div>
      }
        @if(email.errors?.['email']){
        <div class="alert alert-warning mt-2" >
          Please enter a valid email.
        </div>
      }
      </div>
    }
    </div>

  <!-- Mobiles -->
    <div class="mb-3">
      <label class="form-label">Mobile Numbers</label>

    @for (m of user.phoneNumber; track $index) {
    <div class="mb-2">
      <div class="input-group">
        <input type="text" class="form-control" name="mobile{{$index}}" [(ngModel)]="user.phoneNumber[$index]"
          #mobile="ngModel" required pattern="^[0-9]{11}$" [class.is-invalid]="mobile.invalid && mobile.touched"
          [class.is-valid]="mobile.valid && mobile.touched">

        <button class="btn btn-danger" type="button" *ngIf="$index > 0" (click)="removeMobile($index)">
          Remove
        </button>
      </div>

      <!-- رسائل اللوحة حسب نوع الفاليديشن -->
      <div *ngIf="mobile.invalid && mobile.touched">
        <div class="alert alert-danger mt-2" *ngIf="mobile.errors?.['required']">
          Mobile number is required.
        </div>
        <div class="alert alert-warning mt-2" *ngIf="mobile.errors?.['pattern']">
          Mobile must be 11 digits only.
        </div>
      </div>
    </div>
    }

    <button class="btn btn-secondary mt-2" type="button" (click)="addMobile()">Add another mobile</button>
  </div>



    <!-- Password -->
    <div class="mb-3">
      <label class="form-label">Password</label>
      <input type="password"
             name="password"
             class="form-control"
             [(ngModel)]="user.password"
             #password="ngModel"
             required minlength="6"
             [class.is-invalid]="password.invalid && password.touched"
             [class.is-valid]="password.valid">

      @if(password.invalid && password.touched){
      <div>
        @if(password.errors?.['required']){
        <div class="alert alert-danger mt-2">
          Password is required.
        </div>
      }
        @if(password.errors?.['minlength']){
        <div class="alert alert-warning mt-2">
          Password must be at least 6 characters.
        </div>
      }
      </div>
    }
    </div>

    <!-- Submit -->
    <button class="btn btn-primary" [disabled]="regForm.invalid">
      Register
    </button>

  </form>
</div>
